import{r as l}from"./app.4eaf8dc0.js";import{a as v,b as d}from"./index.959372bf.js";function $(){const s=l([]),t=l(0),c=l([]),p=l([]),n=l([]),o=l([]),m=l(!1),h=a=>Object.entries(a).reduce((e,[r,u])=>(Array.isArray(u)?u.forEach(f=>e.append(`${r}[]`,f.file)):e.append(r,u),e),new FormData),i=async()=>{s.value=[],o.value=[];try{t.value=1;let a=await v.get("/announcements");c.value=a.data.data,t.value=2,c.value.forEach(e=>{o.value.push({id:e.id,value:!1,children:[]})})}catch(a){if(t.value=0,a.response.status==422)for(const e in a.response.data.errors)s.value.push(a.response.data.errors[e][0].replace("id",""));else a.response.status==401?(localStorage.removeItem("user"),localStorage.removeItem("tokenUser"),localStorage.removeItem("recent_search"),location.href="/"):s.value.push(a.response.data.message)}};return{chks:o,chkAll:m,errors:s,loading:t,checkAll:async()=>{m.value?o.value.forEach(a=>{a.value||(a.value=!0,n.value.push(a.id))}):(o.value.forEach(a=>{a.value=!1}),n.value=[])},cleanErrors:()=>{s.value=[]},announcement:p,announcements:c,getAnnouncement:async a=>{s.value=[];try{t.value=1;let e=await v.get(`/announcements/${a}`);p.value=e.data.data,t.value=2}catch(e){if(t.value=0,e.response.status==422)for(const r in e.response.data.errors)s.value.push(e.response.data.errors[r][0].replace("id",""));else e.response.status==401?(localStorage.removeItem("user"),localStorage.removeItem("tokenUser"),localStorage.removeItem("recent_search"),location.href="/"):s.value.push(e.response.data.message)}},getAnnouncements:i,toogleDeleteArray:async a=>{if(o.value[a].value)n.value.push(o.value[a].id);else{let e=n.value.indexOf(o.value[a].id);n.value.splice(e,1)}},updateAnnouncement:async(a,e)=>{s.value=[];try{t.value=1,await d.post(`/announcements/${e}`,a),t.value=2}catch(r){if(t.value=0,r.response.status==422)for(const u in r.response.data.errors)s.value.push(r.response.data.errors[u][0].replace("id",""));else r.response.status==401?(localStorage.removeItem("user"),localStorage.removeItem("tokenUser"),localStorage.removeItem("recent_search"),location.href="/"):s.value.push(r.response.data.message)}},createAnnouncement:async a=>{s.value=[];try{t.value=1,await d.post("/announcements",h(a)),t.value=2}catch(e){if(t.value=0,e.response.status==422)for(const r in e.response.data.errors)s.value.push(e.response.data.errors[r][0].replace("id",""));else e.response.status==401?(localStorage.removeItem("user"),localStorage.removeItem("tokenUser"),localStorage.removeItem("recent_search"),location.href="/"):s.value.push(e.response.data.message)}},deleteAnnouncements:async()=>{s.value=[];try{await v.delete(`/announcements/${JSON.stringify(n.value)}`),n.value=[],await i()}catch(a){if(t.value=0,a.response.status==422)for(const e in a.response.data.errors)s.value.push(a.response.data.errors[e][0].replace("id",""));else a.response.status==401?(localStorage.removeItem("user"),localStorage.removeItem("tokenUser"),localStorage.removeItem("recent_search"),location.href="/"):s.value.push(a.response.data.message)}},getAnnouncementUser:async a=>{s.value=[];try{t.value=1;let e=await v.get(`/announcements-user/${a}`);c.value=e.data.data,t.value=2,c.value.forEach(r=>{o.value.push({id:r.id,value:!1,children:[]})})}catch(e){if(t.value=0,e.response.status==422)for(const r in e.response.data.errors)s.value.push(e.response.data.errors[r][0].replace("id",""));else e.response.status==401?(localStorage.removeItem("user"),localStorage.removeItem("tokenUser"),localStorage.removeItem("recent_search"),location.href="/"):s.value.push(e.response.data.message)}}}}export{$ as u};
